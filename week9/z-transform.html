<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="discrete-time-systems-and-the-z-transform">Discrete-Time Systems and the Z-Transform</h1>
<p>Dr Chris Jobling (<script type="text/javascript">
<!--
h='&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#46;&#x61;&#x63;&#46;&#x75;&#x6b;';a='&#64;';n='&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'" clas'+'s="em' + 'ail">'+e+'<\/'+'a'+'>');
// -->
</script><noscript>&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;&#32;&#x61;&#116;&#32;&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#32;&#100;&#x6f;&#116;&#32;&#x61;&#x63;&#32;&#100;&#x6f;&#116;&#32;&#x75;&#x6b;</noscript>)</p>
<p>Digital Technium 123</p>
<p>Office Hours: 12:00-13:00 Mondays</p>
<p>You can view the notes for this presentation in <a href="http://cpjobling.github.io/EG-247-Resources/week9/z-transform.html">HTML</a> and <a href="http://cpjobling.github.io/EG-247-Resources/week9/z-transform.pdf">PDF</a>.</p>
<p>The source code of this presentation is available in Markdown format from GitHub: <a href="https://github.com/cpjobling/EG-247-Resources/tree/master/week9/z-transform.md">ft2.md</a>.</p>
<p>The GitHub repository <a href="https://github.com/cpjobling/EG-247-Resources">EG-247 Resources</a> also contains the source code for all the Matlab/Simulink examples and the Laboratory Exercises.</p>
<h2 id="scope-and-background-reading">Scope and Background Reading</h2>
<p>This session introduces the z-transform which is used in the analysis of discrete time systems. As for the Fourier and Laplace transforms, we present the definition, define the properties and give some applications of the use of the z-transform in the analysis of signals that are represented as sequences and systems represented by difference equations.</p>
<p>The material in this presentation and notes is based on Chapter 10 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10547416">Steven T. Karris, Signals and Systems: with Matlab Computation and Simulink Modelling, 5th Edition</a> from the <strong>Required Reading List</strong>. Additional coverage is to be found in Chapter 13 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10228195">Benoit Boulet, Fundamentals of Signals and Systems</a> from the <strong>Recommended Reading List</strong>.</p>
<h2 id="agenda">Agenda</h2>
<ul>
<li>Introduction</li>
<li>The Z-Transform</li>
<li>Properties of the Z-Transform</li>
<li>Some Selected Z-Transforms</li>
<li>Relationship between Laplace and Z-Transform</li>
<li>Stability Regions</li>
</ul>
<h1 id="introduction">Introduction</h1>
<h2 id="introduction-1">Introduction</h2>
<div class="figure">
<img src="pictures/ct-to-dt.png" alt="CT to DT" />
<p class="caption">CT to DT</p>
</div>
<p>In the remainder of this course we turn our attention to how we model and analyse the behaviour of the central block in this picture.</p>
<h2 id="nature-of-the-signals">Nature of the signals</h2>
<div class="figure">
<img src="pictures/ct-to-dt-to-sequence.png" alt="CT to DT to Sequence" />
<p class="caption">CT to DT to Sequence</p>
</div>
<ul>
<li>The signals we process in discrete time systems are <em>sequences</em> of values <span class="math">\(x[n]\)</span> where <span class="math">\(n\)</span> is an index.</li>
</ul>
<div class="notes">
<p>A sequence can be obtained in real-time, e.g. as the output of a ADC, or can be stored in digital memory; processed and re-stored; or processed and output in real-time, for example in digital music.</p>
</div>
<h2 id="nature-of-the-systems">Nature of the systems</h2>
<ul>
<li>The input to a discrete time system is a squences of values <span class="math">\(x[n]\)</span></li>
<li>The output is also a sequence <span class="math">\(y[n]\)</span></li>
<li>The block represents the operations that convert <span class="math">\(x[n]\)</span> into <span class="math">\(y[n]\)</span>.</li>
<li>This processing takes the form of a <em>difference equation</em></li>
<li>This is analogous to the representation of continuous-time operations by differential equations.</li>
</ul>
<h2 id="transfer-function-model-of-a-dt-system">Transfer function model of a DT system</h2>
<ul>
<li>In CT systems we use the Laplace transform to simplify the analysis of the differential equations</li>
<li>In DT systems the z-Transform allows us to simplify the analysis of difference equations</li>
<li>In CT systems application of the Laplace transform allows us to represent systems as transfer functions and solve convolution problems by multiplication</li>
<li>The z-transform provides analogous tools for the analysis of DT systems.</li>
</ul>
<h1 id="the-z-transform">The Z-Transform</h1>
<h2 id="the-z-transform-1">The Z-Transform</h2>
<p><span class="math">\[\mathcal{Z}\left\{f[n]\right\} = F(z) = \sum_{n=0}^{\infty} f[n]z^{-n}\]</span></p>
<p><span class="math">\[{{\cal Z}^{ - 1}}\left\{ {F(z)} \right\} = f[z] = \frac{1}{{2\pi
j}}\oint\limits_{} {F(z){z^{k - 1}}\,dz}\]</span></p>
<h2 id="sampling-and-the-z-transform">Sampling and the Z-Transform</h2>
<p>In the last lecture we showed that sampling could be represented as the multiplication of a CT signal by a periodic train of impulses:</p>
<p><span class="math">\[x_s(t) = x(t)\sum_{n=0}^{\infty}\delta(t-nT_s)\]</span></p>
<p>By the sampling property of <span class="math">\(\delta(t)\)</span></p>
<p><span class="math">\[x_s(t) = \sum_{n=0}^{\infty}x(nT_s)\delta(t-nT_s)\]</span></p>
<hr />
<p>Using the Laplace transform pairs <span class="math">\(\delta(t) \Leftrightarrow 1\)</span> and <span class="math">\(\delta(t-T) \Leftrightarrow e^{-sT}\)</span> we obtain:</p>
<p><span class="math">\[X_s(t) = \mathcal{L}\left\{\sum_{n=0}^{\infty}x(nT_s)\delta(t-nT_s)\right\} =
\sum_{n=0}^{\infty}x(nT_s)e^{-nsT_s}\]</span></p>
<p>By substitution of <span class="math">\(z = e^{sT_s}\)</span> and representing samples <span class="math">\(x(nT_s)\)</span> as sequence <span class="math">\(x[n]\)</span>:</p>
<p><span class="math">\[X(z) = \sum_{n=0}^{\infty}x[n]z^{-1}\]</span></p>
<h2 id="properties-of-the-z-transform">Properties of the z-Transform</h2>
<p>See <a href="http://cpjobling.github.io/EG-247-Resources/week9/zt_props.html">Properties of the z-Transform</a></p>
<h1 id="some-selected-common-z-transforms">Some Selected Common z-Transforms</h1>
<h2 id="the-geometric-sequence">The Geometric Sequence</h2>
<p><span class="math">\[f[n] = \left\{ {\begin{array}{*{20}{c}}
0&amp;{n =  - 1, - 2, - 3, \ldots }\\
{{a^n}}&amp;{n = 0,1,2,3, \ldots }
\end{array}} \right.\]</span></p>
<p><span class="math">\[F(z) = \sum_{n=0}^{\infty}f[n]z^{-n} = \sum_{n=0}^{\infty}a^n z^{-n} =
\sum_{n=0}^{\infty}\left(az^{-1}\right)^n\]</span></p>
<p>After some analysis (see notes), this can be shown to have a <em>closed-form</em> expression</p>
<p><span class="math">\[F(z) = \frac{1}{1-az^{-1}}=\frac{z}{z -a}\]</span></p>
<div class="notes">
<p><strong>Foot Notes</strong></p>
<ol style="list-style-type: decimal">
<li><p>See Karris pp 9-12—9-13 for the details</p></li>
<li>This function converges only if <span class="math">\(|z| &lt; |a|\)</span> and the region of convergence is outside the circle centred at <span class="math">\(z=0\)</span> with radius <span class="math">\(r=|a|\)</span></li>
</ol>
</div>
<h2 id="region-of-convergence">Region of convergence</h2>
<div class="figure">
<img src="pictures/roc.png" alt="Region of Convergence" />
<p class="caption">Region of Convergence</p>
</div>
<h2 id="the-delta-sequence">The Delta Sequence</h2>
<p><span class="math">\[\delta [n] = \left\{ {\begin{array}{*{20}{c}}
1&amp;{n = 0}\\
0&amp;{{\rm{otherwise}}}
\end{array}} \right.\]</span></p>
<p><span class="math">\[\mathcal{Z}\left\{\delta [n]\right\} = \Delta[z] =
\sum_{n=0}^{\infty}\delta[n]z^{-n} = 1 + \sum_{n=1}^{\infty}0z^{-n} =1\]</span></p>
<p><span class="math">\[\delta [n] \Leftrightarrow 1\]</span></p>
<h2 id="the-unit-step">The Unit Step</h2>
<p><span class="math">\[{u_0}[n] = {\rm{ }}\left\{ {\begin{array}{*{20}{c}}
0&amp;{n &lt; 0}\\
1&amp;{n \ge 0}
\end{array}} \right.\]</span></p>
<div class="figure">
<img src="pictures/unitstep.png" alt="Unit step" />
<p class="caption">Unit step</p>
</div>
<h2 id="z-transform-of-unit-step">Z-Transform of Unit Step</h2>
<p><span class="math">\[\mathcal{Z}\left\{u_0 [n]\right\} U_0(z) = \sum_{n=0}^{\infty}u_0[n]z^{-n}
=\sum_{n=0}^{\infty}z^{-n}\]</span></p>
<p>This is a special case of the geometric sequence with <span class="math">\(a = 1\)</span> so</p>
<p><span class="math">\[U_0(z) = \frac{1}{1-z^{-1}} = \frac{z}{z - 1}\]</span></p>
<p>Region of convergence is <span class="math">\(|z| &gt; 1\)</span></p>
<h2 id="exponential-decay-sequence">Exponential Decay Sequence</h2>
<p><span class="math">\[f[n] = e^{naT_s}{u_0}[n]\]</span></p>
<p><span class="math">\[F(z) = \sum_{n=0}^{\infty}e^{-nasT_s}z^{-n}
=1+e^{-aT_s}z^{-1}+e^{-2aT_s}z^{-2}+e^{-a3T_s}z^{-3}+\cdots\]</span></p>
<p>This is a geometric sequence with <span class="math">\(a = e^{-aT_s}\)</span>, so</p>
<p><span class="math">\[\mathcal{Z}\left\{e^{naT_s}{u_0}[n]\right\} = \frac{1}{1-e^{-aT_s}z^{-1}} =
\frac{z}{z-e^{-aT_s}}\]</span></p>
<p>Region of convergence is <span class="math">\(|e^{-aT_s}z^{-1}| &lt; 1\)</span></p>
<h2 id="ramp-function">Ramp Function</h2>
<p><span class="math">\[f[n] = nu_0[n]\]</span></p>
<p><span class="math">\[\mathcal{Z}\left\{nu_0[n]\right\}=\sum_{n=0}^{\infty} nz^{-n} = 0 +
z^{-1}+2z^{-2}+3z^{-3}+\cdots\]</span></p>
<p>We recognize this as a signal <span class="math">\(u_0[n]\)</span> multiplied by <span class="math">\(n\)</span> for which we have the property <span class="math">\[nf[n] \Leftrightarrow -z\frac{d}{dz}F(z)\]</span></p>
<p>After applying the property and some manipulation, we arrive at:</p>
<p><span class="math">\[nu_0[n] \Leftrightarrow \frac{z}{(z-1)^2}\]</span></p>
<h2 id="table-of-z-transform-pairs">Table of z-Transform Pairs</h2>
<p>As usual, we can rely on this and similar analysis to have been tabulated for us and in practice we can rely on tables of transform pairs, such as this one: <a href="http://cpjobling.github.io/EG-247-Resources/week9/zt_table.html">z-Transform Tables</a></p>
<h1 id="relationship-between-the-laplace-and-z-transform">Relationship Between the Laplace and Z-Transform</h1>
<h2 id="relationship-between-the-laplace-and-z-transform-1">Relationship Between the Laplace and Z-Transform</h2>
<p>Given that we can represent a sampled signal in the complex frequency domain as the infinite sum of each sequence value delayed by an integer multiple of the sampling time:</p>
<p><span class="math">\[F(s) = \sum_{n=0}^{\infty}f[n]e^{-nsT_s}\]</span></p>
<p>And by definition, the z-transform of such a sequence is:</p>
<p><span class="math">\[F(z) = \sum_{n=0}^{\infty}f[n]z^{-n}\]</span></p>
<hr />
<p>It follows that</p>
<p><span class="math">\[z = e^{sT_s}\]</span></p>
<p>And</p>
<p><span class="math">\[s = \frac{1}{T_s}\ln z\]</span></p>
<h2 id="mapping-of-s-to-z">Mapping of s to z</h2>
<p>Since <span class="math">\(s\)</span> and <span class="math">\(z\)</span> are both complex variables, <span class="math">\(z=e^{sT_s}\)</span> is a mapping from the <span class="math">\(s\)</span>-domain to the <span class="math">\(z\)</span>-domain and <span class="math">\(z = \ln z/T_s\)</span> is a mapping from the <span class="math">\(z\)</span> to <span class="math">\(s\)</span>-domain.</p>
<div class="figure">
<img src="pictures/mapping-s-to-z.png" alt="Mapping of s to z" />
<p class="caption">Mapping of <span class="math">\(s\)</span> to <span class="math">\(z\)</span></p>
</div>
<h2 id="mapping-of-s-to-z-1">Mapping of s to z</h2>
<p>Now, since</p>
<p><span class="math">\[s = \sigma + j\omega\]</span></p>
<p><span class="math">\[z = e^{\sigma T_s + j\omega T_s} = e^{\sigma T_s}e^{j\omega T_s} =
|z|e^{j\theta}\]</span></p>
<p>where <span class="math">\(|z| = e^{\sigma Ts}\)</span> and <span class="math">\(\theta = \omega T_s\)</span>.</p>
<h2 id="introduction-of-sampling-frequency">Introduction of sampling frequency</h2>
<p>Now, since <span class="math">\(T_s = 1/f_s\)</span> then <span class="math">\(\omega_s = 2\pi/f_s\)</span> or <span class="math">\(f_s = \omega_s/(2\pi)\)</span> and <span class="math">\(T_s = 2\pi/\omega_s\)</span></p>
<p>We let</p>
<p><span class="math">\[\theta = \omega T_s = \omega\frac{2\pi}{\omega_s} =
2\pi\frac{\omega}{\omega_s}\]</span></p>
<p>Hence by substitution:</p>
<p><span class="math">\[z = e^{\sigma t}e^{j2\pi\omega/\omega_s}\]</span></p>
<h2 id="interpretation-of-the-mapping-s-to-z">Interpretation of the mapping s to z</h2>
<ul>
<li><p>The quantity <span class="math">\(e^{j2\pi\omega/\omega_s}\)</span> defines a unit-circle in the <span class="math">\(z\)</span>-plane centred at the origin.</p></li>
<li><p>And of course the term <span class="math">\(\sigma\)</span> represents the (stability) boundary between the left- and right-half planes of the <span class="math">\(s\)</span>-plane.</p></li>
<li><p>What are the consequences of this?</p></li>
</ul>
<h2 id="case-i-sigma-0">Case I: <span class="math">\(\sigma &lt; 0\)</span></h2>
<ul>
<li>When <span class="math">\(\sigma &lt; 0\)</span> we see that from <span class="math">\(|z| = e^{\sigma T_s}\)</span> that <span class="math">\(|z| &lt; 1\)</span></li>
<li>The left-half plane of the <span class="math">\(s\)</span>-domain maps into the unit circle in the <span class="math">\(z\)</span>-plane.</li>
<li>Different negative values of <span class="math">\(\sigma\)</span> map onto concentric circles with radius less than unity.</li>
</ul>
<h2 id="case-ii-sigma-0">Case II: <span class="math">\(\sigma &gt; 0\)</span></h2>
<ul>
<li>When <span class="math">\(\sigma &gt; 0\)</span> we see that from <span class="math">\(|z| = e^{\sigma T_s}\)</span> that <span class="math">\(|z| &gt; 1\)</span></li>
<li>The right-half plane of the <span class="math">\(s\)</span>-domain maps outside the unit circle in the <span class="math">\(z\)</span>-plane.</li>
<li>Different positive values of <span class="math">\(\sigma\)</span> map onto concentric circles with radius greater than unity.</li>
</ul>
<h2 id="case-iii-sigma-0">Case III: <span class="math">\(\sigma = 0\)</span></h2>
<ul>
<li>When <span class="math">\(\sigma = 0\)</span>, <span class="math">\(|z| = 1\)</span> and <span class="math">\(\theta = 2\pi\omega/\omega_s\)</span></li>
<li>All values of <span class="math">\(\omega\)</span> lie on the circumference of the unit circle.</li>
</ul>
<h2 id="stability-region---s-plane">Stability Region - s-Plane</h2>
<div class="figure">
<img src="pictures/s-plane.png" alt="Stability Region - s-Plane" />
<p class="caption">Stability Region - s-Plane</p>
</div>
<h2 id="stability-region---z-plane">Stability Region - z-Plane</h2>
<div class="figure">
<img src="pictures/z-plane.png" alt="Stability Region - z-Plane" />
<p class="caption">Stability Region - z-Plane</p>
</div>
<h2 id="frequencies-in-the-z-domain">Frequencies in the z-Domain</h2>
<ul>
<li><p>As a consequence of the result for <strong>Case III</strong> above, we can explore how frequencies (that is is values of <span class="math">\(s=\pm j\omega\)</span>) map onto the <span class="math">\(z\)</span>-plane.</p></li>
<li><p>We already know that these frequencies will map onto the unit circle and by <span class="math">\(\theta = 2\pi\omega/\omega_s\)</span> the angles are related to the sampling frequency.</p></li>
<li><p>Let's see how</p></li>
</ul>
<h2 id="mapping-of-multiples-of-sampling-frequency">Mapping of multiples of sampling frequency</h2>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math">\(\omega\)</span> [radians/sec]</th>
<th align="center"><span class="math">\(|z|\)</span></th>
<th align="center"><span class="math">\(\theta\)</span> [radians]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(\omega_s/8\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(\pi/4\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(\omega_s/4\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(\pi/2\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(3\omega_s/8\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(3\pi/4\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(\omega_s/2\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(\pi\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(5\omega_s/8\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(5\pi/4\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(3\omega_s/4\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(3\pi/2\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(7\omega_s/8\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(7\pi/4\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(\omega_s\)</span></td>
<td align="center">1</td>
<td align="center"><span class="math">\(2\pi\)</span></td>
</tr>
</tbody>
</table>
<h2 id="mapping-of-s-plane-to-z-plane">Mapping of s-plane to z-plane</h2>
<div class="figure">
<img src="pictures/s-to-z-mapping.png" alt="Mapping of s-plane to z-plane" />
<p class="caption">Mapping of s-plane to z-plane</p>
</div>
<h2 id="mapping-z-plane-to-s-plane">Mapping z-plane to s-plane</h2>
<p>There is no unique mapping of <span class="math">\(z\)</span> to <span class="math">\(s\)</span> since</p>
<p><span class="math">\[s = \frac{1}{T_s} \ln z\]</span></p>
<p>but for a complex variable</p>
<p><span class="math">\[\ln z = \ln z \pm j2n\pi\]</span></p>
<p>This is in agreement with the theoretical idea that in the frequency domain, sampling creates an infinite number of spectra, each of which is centred around <span class="math">\(\pm n\omega_s\)</span>.</p>
<h2 id="frequency-aliasing">Frequency aliasing</h2>
<ul>
<li>It's worth observing that any stable complex pole in the <span class="math">\(s\)</span>-plane <span class="math">\(s=-\sigma + j\omega\)</span> will have complex conjugate pair <span class="math">\(s = -\sigma - j\omega\)</span>.</li>
<li>Providing <span class="math">\(\omega &lt; \omega_s/2\)</span> these poles will be mapped to the upper and lower half-plane of the <span class="math">\(z\)</span>-plane respectively.</li>
<li>If <span class="math">\(\omega &gt; \omega_s/2\)</span>, an upper-half plane pole will be mapped to the lower-half plane and will have an effective frequency of <span class="math">\(\omega_s/2 - \omega\)</span>.</li>
<li>Similarly, its conjugate pair will move into the upper-half plane.</li>
</ul>
<p>This is another way of looking at <em>aliasing</em>.</p>
<ul>
<li>Also, any poles with frequency <span class="math">\(\omega &gt; \omega_s\)</span> will also be aliased back into into the unit circle.</li>
</ul>
<h2 id="summary">Summary</h2>
<ul>
<li>Introduction</li>
<li>The Z-Transform</li>
<li>Properties of the Z-Transform</li>
<li>Some Selected Z-Transforms</li>
<li>Relationship Between Laplace and Z-Transform</li>
<li>Stability Regions</li>
</ul>
<p><em>Next session</em></p>
<ul>
<li>The Inverse Z-Transform – an examples class</li>
</ul>
<h2 id="homework">Homework</h2>
<p>Problems 1 to 3 in <strong>Section 9.10 Exercises</strong> of Karris explore the z-Transform.</p>
</body>
</html>
