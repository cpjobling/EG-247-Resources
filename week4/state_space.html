<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="modelling-systems-in-state-space">Modelling Systems in State Space</h1>
<p>Dr Chris Jobling (<script type="text/javascript">
<!--
h='&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#46;&#x61;&#x63;&#46;&#x75;&#x6b;';a='&#64;';n='&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'" clas'+'s="em' + 'ail">'+e+'<\/'+'a'+'>');
// -->
</script><noscript>&#x63;&#46;&#112;&#46;&#106;&#x6f;&#98;&#108;&#x69;&#110;&#x67;&#32;&#x61;&#116;&#32;&#x73;&#x77;&#x61;&#110;&#x73;&#x65;&#x61;&#32;&#100;&#x6f;&#116;&#32;&#x61;&#x63;&#32;&#100;&#x6f;&#116;&#32;&#x75;&#x6b;</noscript>)</p>
<p>Digital Technium 123</p>
<p>Office Hours: 12:00-13:00 Mondays</p>
<p>You can view the notes for this presentation in <a href="http://cpjobling.github.io/EG-247-Resources/week4/state_space.html">HTML</a> and <a href="http://cpjobling.github.io/EG-247-Resources/week4/state_space.pdf">PDF</a>.</p>
<p>The source code of this presentation is available in Markdown format from GitHub: <a href="https://github.com/cpjobling/EG-247-Resources/tree/master/week4/state_space.md">Introduction.md</a>.</p>
<p>The GitHub repository <a href="https://github.com/cpjobling/EG-247-Resources">EG-247 Resources</a> also contains the source code for all the Matlab/Simulink examples and the Laboratory Exercises.</p>
<h2 id="scope-and-background-reading">Scope and Background Reading</h2>
<p>This session is an introduction to state variables and state equations as they apply to circuit analysis. The state transition matrix is defined and the state- space to transfer function equivalence is presented. Several examples are given to illustrate their application.</p>
<p>Matlab has particularly strong support for both numeric and symbolic computation of models based on the state-space model and transfer functions so we will not present the detailed mathematical proofs nor bother with the hand-solution of state-space problems. (Nor will we expect you to!)</p>
<p>You will however gain some insight into the power of the state-space model for modelling and simulation in the lab to follow.</p>
<p>If you are interested in the hand calculations, Chapter 5 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10547416">Steven T. Karris, Signals and Systems: with Matlab Computation and Simulink Modelling, 5th Edition.</a> gives full details.</p>
<h2 id="agenda">Agenda</h2>
<ul>
<li>The Idea of a State Space Model</li>
<li>Solving the First-Order Case</li>
<li>Outline of the General Solution</li>
<li>Circuit Analysis with State-Space Models</li>
<li>Transfer Function from State-Space Model</li>
</ul>
<p>Lab</p>
<ul>
<li>Using the Computer for Analysis</li>
<li>Modelling and Simulation with Simulink</li>
<li>The LTI Model in Matlab</li>
</ul>
<h1 id="the-idea-of-a-state-space-model">The Idea of a State-Space Model</h1>
<h2 id="the-idea-of-a-state-space-model-1">The Idea of a State-Space Model</h2>
<ul>
<li>In circuits when doing analysis with KCL and KVL we obtain integro- differential equations as a result of the energy-storing devices (inductors and capacitors)</li>
<li>When a circuit contains one such device, it is said to be a <em>first-order circuit</em></li>
<li>When a circuit contains two such devices, it is said to be a <em>second-order circuit</em>, and so on.</li>
</ul>
<h2 id="first-order-linear-time-invariant-system">First-order linear time invariant system</h2>
<p>A first-order linear, time-invariant (LTI) system can be represented by a differential equation of the form</p>
<p><span class="math">\[a_1\frac{d}{dt}y(t)+a_0 y(t)=u(t)\]</span></p>
<h2 id="second-order-lti-system">Second-order LTI system</h2>
<p>A second-order LTI system can be represented by a differential equation of the form</p>
<p><span class="math">\[a_2\frac{d^2}{dt^2}y(t)+a_1\frac{d}{dt}y(t) + a_0 y(t)=u(t)\]</span></p>
<h2 id="nth-order-lti-system">nth-order LTI system</h2>
<p>By extension, an <em>n</em><sup>th</sup>-order LTI system can be represented by a differential equation of the form</p>
<p><span class="math">\[a_n\frac{d^n}{dt^n}y(t)+a_{n-1}\frac{d^{n-1}}{dt^{n-1}}y(t)+\cdots
+a_1\frac{d}{dt}y(t) + a_0 y(t)=u(t)\]</span></p>
<h2 id="example-1">Example 1</h2>
<p>A series RLC circuit with excitation</p>
<p><span class="math">\[v_s(t) = e^{j\omega t}\]</span></p>
<p>is described the the integro-differential equation</p>
<p><span class="math">\[Ri(t) + L\frac{d}{dt}i(t)+\frac{1}{C}\int_{-\infty}^{t}i(t) dt = e^{j\omega
t}\]</span></p>
<p>Convert the equation into a second-order differential form and from this derive a state-space model.</p>
<h2 id="solution-1---step-1">Solution 1 - Step 1</h2>
<p>Differentiating both sides of the equation and dividing by <span class="math">\(L\)</span> we get</p>
<p><span class="math">\[\frac{d^2}{dt^2}i(t) + \frac{R}{L}\frac{d}{dt}i(t) + \frac{1}{LC} i(t) =
\frac{1}{L}j\omega e^{j\omega t}\]</span></p>
<p>or</p>
<p><span class="math">\[\frac{d^2}{dt^2}i(t) = - \frac{R}{L}\frac{d}{dt}i(t) - \frac{1}{LC} i(t) +
\frac{1}{L}j\omega e^{j\omega t}\]</span></p>
<h2 id="step-2-define-state-variables">Step 2: Define state variables</h2>
<p>Let us define <span class="math">\(x_1\)</span> and <span class="math">\(x_2\)</span> to be two <em>state variables</em> such that</p>
<p><span class="math">\[x_1 = i\]</span></p>
<p>and</p>
<p><span class="math">\[x_2 = \frac{di}{dt} = \frac{dx_1}{dt} = \dot{x}_1\]</span></p>
<p>then</p>
<p><span class="math">\[\dot{x}_2 = \frac{dx_1}{dt} = \frac{d^2i}{dt^2}\]</span></p>
<h2 id="step-3-recast-differential-equation-in-terms-of-the-state-variables">Step 3: Recast differential equation in terms of the state variables</h2>
<p><span class="math">\[\dot{x}_1 = x_2\]</span></p>
<p><span class="math">\[\dot{x}_2 = - \frac{R}{L} x_2 - \frac{1}{LC} x_1 + \frac{1}{L}j\omega
e^{j\omega t}\]</span></p>
<h2 id="step-4-put-into-matrix-vector-form">Step 4: Put into matrix-vector form</h2>
<p><span class="math">\[\left[ {\begin{array}{*{20}{c}}
{{{\dot x}_1}}\\
{{{\dot x}_2}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
0&amp;1\\
{ - \frac{1}{{LC}}}&amp;{ - \frac{R}{L}}
\end{array}} \right]\left[ {\begin{array}{*{20}{c}}
{{x_1}}\\
{{x_2}}
\end{array}} \right] + \left[ {\begin{array}{*{20}{c}}
0\\
{\frac{1}{L}}
\end{array}} \right]j\omega {e^{j\omega t}}\]</span></p>
<h2 id="step-5-state-space-form">Step 5: State-space form</h2>
<p><span class="math">\[{\bf{\dot x}} = {\bf{Ax}} + {\bf{B}}u\]</span></p>
<p>where</p>
<p><span class="math">\({\bf{\dot x}} = \left[ {\begin{array}{*{20}{c}} {{\dot{x}_1}}\\ {{\dot{x}_2}} \end{array}} \right]\)</span> <span class="math">\({\bf{A}} = \left[ {\begin{array}{*{20}{c}} 0&amp;1\\ { - \frac{1}{{LC}}}&amp;{ - \frac{R}{L}} \end{array}} \right]\)</span> <span class="math">\({\bf{x}} = \left[ {\begin{array}{*{20}{c}} {{x_1}}\\ {{x_2}} \end{array}} \right]\)</span> <span class="math">\({\bf{B}} = \left[ {\begin{array}{*{20}{c}} 0\\ {\frac{1}{L}} \end{array}} \right]\)</span> and <span class="math">\(u=j\omega e^{j\omega t}\)</span>.</p>
<p>The output <span class="math">\(y(t)\)</span> is expressed by the state-equation</p>
<p><span class="math">\[y = {\bf{C}}{\bf{x}} + d u\]</span></p>
<p>where <span class="math">\(\bf{C}\)</span> is another matrix, and <span class="math">\(d\)</span> is a scalar.</p>
<h2 id="general-state-space-form">General State-Space Form</h2>
<p>For a single-input single-output (SISO) system:</p>
<p><span class="math">\[\begin{array}{l}
{\bf{\dot x}} = {\bf{Ax}} + {\bf{B}}u\\
{\bf{y}} = {\bf{Cx}} + d u
\end{array}\]</span></p>
<div class="figure">
<img src="pictures/state_space_model.png" alt="General state-space form" />
<p class="caption">General state-space form</p>
</div>
<h2 id="example-2">Example 2</h2>
<p>A fourth-order network is decsribed by the differential equation</p>
<p><span class="math">\[\frac{d^4 y}{dt^4} + a_3\frac{d^3 y}{dt^3} + a_2 \frac{d^2 y}{dt^2} + a_1
\frac{d y}{dt} + a_0 y(t) = u(t)\]</span></p>
<p>where <span class="math">\(y(t)\)</span> represents the circuit output as a current or voltage, and <span class="math">\(u(t)\)</span> is an arbitrary input.</p>
<p>Express this system in state-space form.</p>
<h2 id="example-3">Example 3</h2>
<p>Write the state equations for the circuit below, given that <span class="math">\(V_c(0^-)=0\)</span>, and <span class="math">\(u_0(t)\)</span> is the unit step.</p>
<div class="figure">
<img src="pictures/example2.png" alt="Example 3" />
<p class="caption">Example 3</p>
</div>
<h2 id="example-4">Example 4</h2>
<p>See Example 5.4 on Pages 5-5â€”5-6 in the textbook.</p>
<h1 id="solving-the-first-order-case">Solving the First-Order Case</h1>
<h2 id="solving-the-first-order-case-1">Solving the First-Order Case</h2>
<p>If a circuit contains only one energy-storing device, the state equations are written as:</p>
<p><span class="math">\[\begin{array}{c}
\dot x = ax + bu\\
y = cx + du
\end{array}\]</span></p>
<p>where <span class="math">\(a\)</span>, <span class="math">\(b\)</span>, <span class="math">\(c\)</span> and <span class="math">\(d\)</span> are scalar constants.</p>
<p>The solution will be of the form</p>
<p><span class="math">\[x(t) = e^{a(t-t_0)}x(t_0)+\int_{t_0}^{t}e^{a(t-\tau)}bu(\tau) d\tau\]</span></p>
<p>(For proof see text-book)</p>
<h2 id="example-5">Example 5</h2>
<p>Use the previous result to find the capacitor voltage <span class="math">\(v_c(t)\)</span> of the circuit below for <span class="math">\(t &gt; 0\)</span>, given that the initial condition is <span class="math">\(v_c(0^-) = 1\;\mathrm{V}\)</span>, <span class="math">\(R=2\;\Omega\)</span>, <span class="math">\(C=0.5\;\mathrm{F}\)</span> and <span class="math">\(v_s(t) = 2u_0(t)\)</span>.</p>
<div class="figure">
<img src="pictures/example2.png" alt="Example 5" />
<p class="caption">Example 5</p>
</div>
<p>(<em>Solution</em>: <span class="math">\(y(t) = x(t) = v_c(t) = (2 - e^{-t})u_0(t)\)</span>)</p>
<h2 id="matlab-solution">Matlab Solution</h2>
<pre class="sourceCode matlab"><code class="sourceCode matlab">t = linspace(<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">1000</span>);
vc = <span class="fl">2</span>-exp(-t);
plot(t,vc),axis([<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">3</span>]),grid</code></pre>
<hr />
<div class="figure">
<img src="pictures/state_space_40_0.png" alt="Matlab solution" />
<p class="caption">Matlab solution</p>
</div>
<h1 id="outline-of-the-general-solution">Outline of the General Solution</h1>
<h2 id="outline-of-the-general-solution-1">Outline of the General Solution</h2>
<p>If</p>
<p><span class="math">\[\begin{array}{l}
{\bf{\dot x}} = {\bf{Ax}} + {\bf{B}}u\\
{\bf{y}} = {\bf{Cx}} + d u
\end{array}\]</span></p>
<p>the the solution of</p>
<p><span class="math">\[{\bf{\dot x}} = {\bf{Ax}} + {\bf{B}}u\]</span></p>
<p>with initial condtions <span class="math">\({\bf{x}}(t_0) = \bf{x}_0\)</span></p>
<p>is the matrix generalization of the previous result:</p>
<p><span class="math">\[{\bf{x}} = {e^{{\bf{A}}t}}{{\bf{x}}_0} + \int_{{t_0}}^t {{e^{{\bf{A}}(t - \tau
)}}{\bf{Bu}}(\tau )d\tau } \]</span></p>
<h2 id="transition-matrix">Transition Matrix</h2>
<p>The term</p>
<p><span class="math">\[{\bf{\phi}}(t)=e^{{\bf{A}}t}\]</span></p>
<p>is called the <em>state transition matrix</em> and it can be computed by hand (at least for the 2x2 case) if you have knowledge of the <em>eigenvalues</em> and <em>eigenvectors</em> of the state-matrix <span class="math">\(\bf A\)</span>.</p>
<p>If you want to study the proof, see Section 5.4 <strong>Computation of the State Transition Matrix</strong> in the text book.</p>
<h2 id="computation-of-the-state-transition-matrix-in-matlab">Computation of the State Transition Matrix in Matlab</h2>
<p>Matlab provides the function <code>expm</code> which computes the matrix exponential</p>
<h2 id="example-6">Example 6</h2>
<p>Compute the state transition matrix <span class="math">\(\bf \phi = e^{{\bf{A}}t}\)</span> for the state matrix</p>
<p><span class="math">\[{\bf{A}} = \left[ {\begin{array}{*{20}{c}}
{ - 2}&amp;1\\
0&amp;{ - 1}
\end{array}} \right]\]</span></p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">syms t;
A = [-<span class="fl">2</span>, <span class="fl">1</span>; <span class="fl">0</span>, -<span class="fl">1</span>];
phi = expm(A*t)

phi =

  [ exp(-<span class="fl">2</span>*t), exp(-t) - exp(-<span class="fl">2</span>*t)]
  [         <span class="fl">0</span>,             exp(-t)]</code></pre>
<p><span class="math">\[\phi (t) = \left[ {\begin{array}{*{20}{c}}
{{e^{ - 2t}}}&amp;{{e^{ - t}} - {e^{ - 2t}}}\\
0&amp;{{e^{ - t}}}
\end{array}} \right]\]</span></p>
<h1 id="circuit-analysis-with-state-space-models">Circuit Analysis with State-Space Models</h1>
<h2 id="example-7">Example 7</h2>
<p>For the RLC circuit shown below, the initial conditions ar <span class="math">\(i_L(0^-)\)</span>=0, and <span class="math">\(v_c(0^-)=0.5\)</span> V. Use the state variable method to compute <span class="math">\(i_L(t)\)</span> and <span class="math">\(v_c(t)\)</span>.</p>
<div class="figure">
<img src="pictures/example6.png" alt="Example 7" />
<p class="caption">Example 7</p>
</div>
<h2 id="sketch-of-solution">Sketch of solution</h2>
<p>See Example 5.10 for full solution.</p>
<p>We chose <span class="math">\(x_1 = i_L\)</span> and <span class="math">\(x_2 = v_c\)</span> as our state variables which yields state equations</p>
<p><span class="math">\[\left[ {\begin{array}{*{20}{c}}
{{{\dot x}_1}}\\
{{{\dot x}_2}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
{ - 4}&amp;{ - 4}\\
{3/4}&amp;0
\end{array}} \right]\left[ {\begin{array}{*{20}{c}}
{{x_1}}\\
{{x_2}}
\end{array}} \right] + \left[ {\begin{array}{*{20}{c}}
1\\
0
\end{array}} \right]{u_0}(t)\]</span></p>
<h2 id="state-transition-matrix">State-transition matrix</h2>
<pre class="sourceCode matlab"><code class="sourceCode matlab">syms t;
A = [-<span class="fl">4</span>, -<span class="fl">4</span>; <span class="fl">3</span>/<span class="fl">4</span>, <span class="fl">0</span>];
phi = expm(A*t);
pretty(phi)

  +-                                                  -+
  |   <span class="fl">3</span> exp(-<span class="fl">3</span> t)   exp(-t)                            |
  |   ----------- - -------,  <span class="fl">2</span> exp(-<span class="fl">3</span> t) - <span class="fl">2</span> exp(-t)  |
  |        <span class="fl">2</span>           <span class="fl">2</span>                               |
  |                                                    |
  |  <span class="fl">3</span> exp(-t)   <span class="fl">3</span> exp(-<span class="fl">3</span> t)   <span class="fl">3</span> exp(-t)   exp(-<span class="fl">3</span> t)   |
  |  --------- - -----------,  --------- - ---------   |
  |      <span class="fl">8</span>            <span class="fl">8</span>            <span class="fl">2</span>           <span class="fl">2</span>       |
  +-                                                  -+</code></pre>
<h2 id="giving">Giving</h2>
<p>The state transition matrix is</p>
<p><span class="math">\[\phi (t) = \left[ {\begin{array}{*{20}{c}}
{ - \frac{1}{2}{e^{ - t}} + \frac{3}{2}{e^{ - 3t}}}&amp;{ - 2{e^{ - t}} + 2{e^{ -
3t}}}\\
{ - \frac{3}{8}{e^{ - t}} + \frac{8}{8}{e^{ - 3t}}}&amp;{ - \frac{3}{2}{e^{ - t}} -
\frac{1}{2}{e^{ - 3t}}}
\end{array}} \right]\]</span></p>
<h2 id="unforced-response">Unforced response</h2>
<p>The <em>unforced response</em> is the response of the state variables to the initial conditions only.</p>
<p>We multiply this by the initial condition matrix, to get the <em>unforced response</em></p>
<p><span class="math">\[{{\bf{x}}_u}(t) = {e^{{\bf{A}}t}}\left[ {\begin{array}{*{20}{c}}
0\\
{\frac{1}{2}}
\end{array}} \right]\]</span></p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">xu = phi*[<span class="fl">0</span>; <span class="fl">1</span>/<span class="fl">2</span>];
pretty(xu)

  +-                       -+
  |   exp(-<span class="fl">3</span> t) - exp(-t)   |
  |                         |
  |  <span class="fl">3</span> exp(-t)   exp(-<span class="fl">3</span> t)  |
  |  --------- - ---------  |
  |      <span class="fl">4</span>           <span class="fl">4</span>      |
  +-                       -+</code></pre>
<p><span class="math">\[{{\bf{x}}_u}(t) = \left[ {\begin{array}{*{20}{c}}
{ - {e^{ - t}} + {e^{ - 3t}}}\\
{\frac{3}{4}{e^{ - t}} - \frac{3}{4}{e^{ - 3t}}}
\end{array}} \right]\]</span></p>
<h2 id="forced-response">Forced response</h2>
<p>The <em>forced response</em> (the response to the input only) is trickier to compute by hand</p>
<p><span class="math">\[{{\bf{x}}_f}(t) = \int_0^t {{e^{\bf{A}(t-\tau) }}{\bf{B}}{u_0}(\tau )} d\tau
\]</span></p>
<hr />
<p>but is easy with Matlab</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">syms t tau
B = [<span class="fl">4</span>; <span class="fl">0</span>];
xf = int(expm(A*(t-tau))*B*heaviside(tau),tau,<span class="fl">0</span>,t)

xf =

      <span class="fl">2</span>*exp(-t) - <span class="fl">2</span>*exp(-<span class="fl">3</span>*t)
  exp(-<span class="fl">3</span>*t)/<span class="fl">2</span> - (<span class="fl">3</span>*exp(-t))/<span class="fl">2</span> + <span class="fl">1</span></code></pre>
<p><span class="math">\[{{\bf{x}}_f}(t) = \left[ {\begin{array}{*{20}{c}}
{2{e^{ - t}} - 2{e^{ - 3t}}}\\
{1 - \frac{3}{2}{e^{ - t}} + \frac{1}{2}{e^{ - 3t}}}
\end{array}} \right]\]</span></p>
<h2 id="overall-response">Overall response</h2>
<p>The overall response is</p>
<p><span class="math">\[{\bf{x}}(t) = {{\bf{x}}_u}(t) + {{\bf{x}}_f}(t)\]</span></p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">x = xu + xf

  x =

               exp(-t) - exp(-<span class="fl">3</span>*t)
   exp(-<span class="fl">3</span>*t)/<span class="fl">4</span> - (<span class="fl">3</span>*exp(-t))/<span class="fl">4</span> + <span class="fl">1</span></code></pre>
<p><span class="math">\[{\bf{x}}(t) = \left[ {\begin{array}{*{20}{c}}
{{e^{ - t}} - {e^{ - 3t}}}\\
{1 - \frac{3}{4}{e^{ - t}} + \frac{1}{4}{e^{ - 3t}}}
\end{array}} \right]\]</span></p>
<h2 id="complete-solution">Complete solution</h2>
<p>So</p>
<p><span class="math">\[x_1 = i_L = e^{-t}+e^{-3t}\]</span></p>
<p>and</p>
<p><span class="math">\[x_2 = v_c = 1 - 0.75e^{-t} + 0.25e^{-3t}\]</span></p>
<p>Which agrees with the text book.</p>
<h2 id="quick-matlab-solution">Quick MATLAB solution</h2>
<p>As a four-liner</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">syms t tau;
A = [-<span class="fl">4</span>, -<span class="fl">4</span>; <span class="fl">3</span>/<span class="fl">4</span>, <span class="fl">0</span>]; B = [<span class="fl">4</span>; <span class="fl">0</span>]; x0 = [<span class="fl">0</span>; <span class="fl">1</span>/<span class="fl">2</span>];
x = expm(A*t)*x0 + ..
  int(expm(A*(t-tau))*B*heaviside(tau),tau,<span class="fl">0</span>,t);
il = x(<span class="fl">1</span>), vc = x(<span class="fl">2</span>)

il =

  exp(-t) - exp(-<span class="fl">3</span>*t)


vc =

  exp(-<span class="fl">3</span>*t)/<span class="fl">4</span> - (<span class="fl">3</span>*exp(-t))/<span class="fl">4</span> + <span class="fl">1</span></code></pre>
<h1 id="transfer-function-from-state-space-model">Transfer Function from State-Space Model</h1>
<h2 id="transfer-function-from-state-space-model-1">Transfer Function from State-Space Model</h2>
<p>We state, without proof, that the laplace transform of the state equations are:</p>
<p><span class="math">\[Y(s) = {\rm{ }}\left[ {{\bf{C}}{{({\bf{sI}} - {\bf{A}})}^{ -
{\bf{1}}}}{\bf{B}} + {\bf{d}}} \right]{\rm{ }}U(s)\]</span></p>
<p>where <span class="math">\(\bf{I}\)</span> is the <em>identity matrix</em> (Matlab <code>eye(n)</code>)</p>
<p>So the transfer fuction of a state-space model with input <span class="math">\(U(s)\)</span> and output <span class="math">\(Y(s)\)</span> is</p>
<p><span class="math">\[G(s) = \frac{Y(s)}{U(s)} = {{\bf{C}}{{({\bf{sI}} - {\bf{A}})}^{ -
{\bf{1}}}}{\bf{B}} + {\bf{d}}}\]</span></p>
<h2 id="example-7-1">Example 7</h2>
<p>Give the transfer function for Example 6 assuming that the output <span class="math">\(y(t) = v_c(t)\)</span> and find the step response of the circuit.</p>
<h2 id="solution">Solution</h2>
<p>if <span class="math">\(y(t) = v_c(t)\)</span></p>
<p><span class="math">\[{\bf{C}} = [\begin{array}{*{20}{c}}
0&amp;1
\end{array}]\]</span></p>
<p>and</p>
<p><span class="math">\[d = 0\]</span></p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">syms t s
C = [<span class="fl">0</span>, <span class="fl">1</span>]; d = <span class="fl">0</span>;
G = C*inv(s*eye(<span class="fl">2</span>)-A)*B + d

G =

    <span class="fl">3</span>/(s^<span class="fl">2</span> + <span class="fl">4</span>*s + <span class="fl">3</span>)</code></pre>
<hr />
<pre class="sourceCode matlab"><code class="sourceCode matlab">U = laplace(heaviside(t));
vc = ilaplace(G*U)

  vc =

    exp(-<span class="fl">3</span>*t)/<span class="fl">2</span> - (<span class="fl">3</span>*exp(-t))/<span class="fl">2</span> + <span class="fl">1</span></code></pre>
<h2 id="another-way-of-looking-at-the-state-transition-matrix">Another way of Looking at the State Transition Matrix</h2>
<p>It can be shown that</p>
<p><span class="math">\[\mathcal{L}e^{\bf{A}t} = \left(s\bf{I}-A\right)^{-1}\]</span></p>
<p>and this gives us another way to find <span class="math">\(e^{\bf{A}t}\)</span>.</p>
<h2 id="example-8">Example 8</h2>
<p>Use Laplace transforms to find the state transition matrix for Example 6.</p>
<h2 id="solution-1">Solution</h2>
<pre class="sourceCode matlab"><code class="sourceCode matlab">syms s t
A = [-<span class="fl">4</span>, -<span class="fl">4</span>; <span class="fl">3</span>/<span class="fl">4</span>, <span class="fl">0</span>];
phi_s = inv(s*eye(<span class="fl">2</span>)-A)
phi_t = ilaplace(phi_s)

phi_s =

  [     s/(s^<span class="fl">2</span> + <span class="fl">4</span>*s + <span class="fl">3</span>),      -<span class="fl">4</span>/(s^<span class="fl">2</span> + <span class="fl">4</span>*s + <span class="fl">3</span>)]
  [ <span class="fl">3</span>/(<span class="fl">4</span>*(s^<span class="fl">2</span> + <span class="fl">4</span>*s + <span class="fl">3</span>)), (s + <span class="fl">4</span>)/(s^<span class="fl">2</span> + <span class="fl">4</span>*s + <span class="fl">3</span>)]


phi_t =

  [     (<span class="fl">3</span>*exp(-<span class="fl">3</span>*t))/<span class="fl">2</span> - exp(-t)/<span class="fl">2</span>,     <span class="fl">2</span>*exp(-<span class="fl">3</span>*t) - <span class="fl">2</span>*exp(-t)]
  [ (<span class="fl">3</span>*exp(-t))/<span class="fl">8</span> - (<span class="fl">3</span>*exp(-<span class="fl">3</span>*t))/<span class="fl">8</span>, (<span class="fl">3</span>*exp(-t))/<span class="fl">2</span> - exp(-<span class="fl">3</span>*t)/<span class="fl">2</span>]</code></pre>
<h2 id="homework">Homework</h2>
<p>Try the end of the chapter exercises (Section 5.9) from the textbook. You can omit Question 6 and may solve Questions 7, 8, and 9 using Matlab. Don't look at the answers until you have attempted the problems.</p>
<h2 id="lab-work">Lab Work</h2>
<p>In the lab, a week on Friday, we will give further examples of computing the state- transition matrix, and its use in the solution of systems defined by state-space models and transfer functions.</p>
<p>We will also introduce the <em>Linear Time Invariant</em> (LTI) model which can be used to model and analyse state-space and transfer functions.</p>
<p>We will also demonstrate the use of Simulink to model and simulate circuits</p>
<h1 id="next-session">Next Session</h1>
<ul>
<li><a href="http://cpjobling.github.io/EG-247-Resources/week4/convolution.html">Time Convolution (Part 1)</a> (<a href="http://cpjobling.gith%20ub.io/EG-247-Resources/week4/convolution.slides.pdf">Slides PDF</a>)</li>
</ul>
</body>
</html>
